// 修改数据源配置
datasource db {
  provider = "mysql"  // 从 "postgresql" 改为 "mysql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
  previewFeatures = ["fullTextSearch", "fullTextIndex"] // MySQL 全文搜索支持
}

// 修改模型中的数据类型和特性：

// User 表修改示例
model User {
  id                String         @id @default(uuid()) // MySQL 8.0+ 支持 UUID
  username          String         @unique @db.VarChar(50)
  email             String         @unique @db.VarChar(100)
  password          String         @db.VarChar(255)
  role              UserRole       @default(USER)
  avatar            String?        @db.Text
  bio               String?        @db.Text
  isActive          Boolean        @default(true)
  emailVerified     Boolean        @default(false)
  lastLogin         DateTime?
  createdAt         DateTime       @default(now())
  updatedAt         DateTime       @updatedAt

  // ... 关系保持不变

  @@index([email])
  @@index([username])
  @@map("users") // 可选：指定表名
}

// ChessRecord 表修改示例
model ChessRecord {
  id           String      @id @default(uuid())
  title        String      @db.VarChar(255)
  description  String?     @db.Text
  type         ChessType
  content      Json        // MySQL 5.7+ 支持 JSON
  thumbnail    String?     @db.Text
  visibility   Visibility  @default(PUBLIC)
  tags         Json        // MySQL 不原生支持数组，改用 JSON
  rating       Float       @default(0) @db.Float
  playCount    Int         @default(0)
  duration     Int?
  difficulty   Difficulty?
  authorId     String
  createdAt    DateTime    @default(now())
  updatedAt    DateTime    @updatedAt

  // ... 关系保持不变

  @@index([authorId])
  @@index([type])
  @@index([visibility])
  @@map("chess_records")
}